<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=5.0, user-scalable=yes">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; base-uri 'self'; object-src 'none'; script-src 'self' https://www.gstatic.com https://www.google.com https://www.recaptcha.net https://apis.google.com; style-src 'self' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https://*.googleapis.com https://firestore.googleapis.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://www.googleapis.com https://firebaseinstallations.googleapis.com https://www.gstatic.com https://apis.google.com https://*.cloudfunctions.net; frame-src https://www.google.com https://www.recaptcha.net https://apes-365b0.firebaseapp.com https://apes-365b0.web.app;">
    <!-- iOS optimizations -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <title>Profile ü¶ç | Apes Together Strong</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css?v=6">
    
    <!-- reCAPTCHA v3 for Firebase App Check -->
    <!-- TODO: Replace YOUR_RECAPTCHA_SITE_KEY with your actual reCAPTCHA v3 site key -->
    <script src="https://www.google.com/recaptcha/api.js?render=YOUR_RECAPTCHA_SITE_KEY" async defer></script>
</head>
<body class="profile-body">
    <!-- Global Header (injected by js/header.js) -->
    <div id="site-header"></div>
    
    <!-- Header Script -->
    <script type="module" src="/js/header.js?v=2"></script>

    <main class="profile-page">
        <div class="profile-container">
            <!-- Banner and Level Section -->
            <div class="profile-banner-bio-row">
                <!-- Banner Image Section -->
                <div class="profile-banner">
                    <div class="profile-banner-bg" id="profileBannerBg"></div>
                    <img id="profileBannerImg" src="/pfp_apes/bg1.png" alt="Profile Banner" />
                </div>
                
                <!-- Level Section -->
                <div class="profile-rank-section">
                    <div class="profile-username" id="profileUsername">Username</div>
                    <div class="profile-rank">
                        <span class="rank-label">LVL</span>
                        <span class="rank-value" id="profileRank">1</span>
                    </div>
                    <div class="rank-progress-bar">
                        <div class="rank-progress-fill" id="rankProgressFill"></div>
                    </div>
                    <!-- Followers/Following Stats -->
                    <div class="profile-follow-stats">
                        <button class="follow-stat-btn" id="followersBtn" type="button">
                            <span class="follow-stat-number" id="followersCount">0</span>
                            <span class="follow-stat-label">Followers</span>
                        </button>
                        <button class="follow-stat-btn" id="followingBtn" type="button">
                            <span class="follow-stat-number" id="followingCount">0</span>
                            <span class="follow-stat-label">Following</span>
                        </button>
                    </div>
                    <!-- Profile Settings and Quests Buttons -->
                    <div class="profile-settings-btn-wrapper">
                        <a href="/profile/settings/" class="btn btn-secondary" id="profileSettingsBtn">
                            ‚öôÔ∏è Profile Settings
                        </a>
                        <a href="/quests/" class="btn btn-secondary" id="profileQuestsBtn">
                            üéØ Quests
                        </a>
                    </div>
                </div>
            </div>

            <!-- Profile Settings and Banner sections moved to /profile/settings/ -->

            <!-- User Posts Section -->
            <section class="profile-posts-section">
                <div class="profile-posts-header">
                    <h3>Posts</h3>
                </div>
                <div class="profile-posts-feed" id="profilePostsFeed">
                    <div class="posts-loading">Loading posts...</div>
                </div>
            </section>
        </div>
    </main>

    <!-- X Verification Instructions Modal -->
    <div class="modal-overlay" id="xInstructionsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>How to Verify Your X Account</h3>
                <button type="button" class="modal-close" id="closeXInstructionsBtn">&times;</button>
            </div>
            <div class="modal-body">
                <ol class="verification-steps">
                    <li>
                        <strong>Enter your X username</strong>
                        <p>Type your X (Twitter) username in the field above (with or without @)</p>
                    </li>
                    <li>
                        <strong>Copy your verification code</strong>
                        <p>After entering your username, a unique verification code will appear. Click the üìã button to copy it.</p>
                    </li>
                    <li>
                        <strong>Add code to your X bio</strong>
                        <p>Go to your X profile settings and edit your bio. Paste the verification code anywhere in your bio text.</p>
                    </li>
                    <li>
                        <strong>Click "Verify X Account"</strong>
                        <p>Once you've added the code to your bio, click the "Verify X Account" button. We'll check if the code is in your bio.</p>
                    </li>
                    <li>
                        <strong>You're verified!</strong>
                        <p>If the code is found in your bio, your X account will be marked as verified. You can remove the code from your bio after verification.</p>
                    </li>
                </ol>
                <div class="verification-note">
                    <p><strong>Note:</strong> The verification code must be in your public X bio for verification to work. Make sure your profile is public or the verification may fail.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="closeXInstructionsBtn2">Got it!</button>
            </div>
        </div>
    </div>

    <!-- Followers/Following Modals -->
    <div class="modal-overlay hide" id="followersModal">
        <div class="modal-content follow-modal">
            <div class="modal-header">
                <h3>Followers</h3>
                <button type="button" class="modal-close" id="closeFollowersModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="follow-search-container">
                    <input type="text" class="follow-search-input" id="followersSearchInput" placeholder="Search followers..." />
                </div>
                <div class="follow-list" id="followersList">
                    <div class="follow-list-loading">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay hide" id="followingModal">
        <div class="modal-content follow-modal">
            <div class="modal-header">
                <h3>Following</h3>
                <button type="button" class="modal-close" id="closeFollowingModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="follow-search-container">
                    <input type="text" class="follow-search-input" id="followingSearchInput" placeholder="Search following..." />
                </div>
                <div class="follow-list" id="followingList">
                    <div class="follow-list-loading">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/js/profile-init.js?v=3"></script>
    <script type="module" src="/js/asset-selftest.js?v=2"></script>
</body>
</html>
